app.controller("EditUpdowncntr",["$scope","$rootScope","$http","$timeout","$stateParams","$document","Dialog","$mdDialog","$location","focus",function(a,t,e,n,c,o,i,r,s,y){a.MatchName=c.MatchName,a.rangeLimit=10,a.setMessage=function(t){if(1==t)var n="Wicket Down";else if(2==t)var n="Decision Pending";else if(3==t)var n=a.otherTxtMsg;var o=parseInt(c.FancyID),i=parseInt(c.TypeID),r={FancyId:o,TypeId:i,message:n},s=BASE_URL+"Lstsavemstrcontroller/setFancyMsg/";e.post(s,r).success(function(t){a.GetFancyData()})},a.GetFancyData=function(){e.get(BASE_URL+"Updowncntr/getFancyByEdit/"+c.FancyID+"/"+c.TypeID).success(function(e,n,c,o){a.SessionData=e.FancyData,a.ID=e.FancyData[0].ID,a.downLay=parseInt(e.FancyData[0].upDwnLay),a.UpBack=parseInt(e.FancyData[0].upDwnBack),a.active=parseInt(e.FancyData[0].active),a.Liability=parseInt(e.FancyData[0].upDwnLimit),a.TypeID=e.FancyData[0].TypeID,a.pointDiff=parseInt(e.FancyData[0].pointDiff),a.rateDiff=parseInt(e.FancyData[0].rateDiff),a.MaxStake=parseInt(e.FancyData[0].MaxStake),a.MatchID=e.FancyData[0].MatchID,t.active=parseInt(e.FancyData[0].active),a.otherMsgVal=!1,a.DisplayMsg=e.FancyData[0].DisplayMsg,a.RateChange=e.FancyData[0].RateChange,a.NoLayRange=parseInt(e.FancyData[0].upDwnLay)-a.rangeLimit,a.YesLayRange=parseInt(e.FancyData[0].upDwnBack)+a.rangeLimit,a.pointDiff=parseInt(e.FancyData[0].pointDiff),a.rateDiff=parseInt(e.FancyData[0].rateDiff),a.MaxStake=parseInt(e.FancyData[0].MaxStake),1==a.active?(document.getElementById("downLay").disabled=!0,document.getElementById("downLay").readOnly=!0,y("downLay")):(a.downLay="",a.UpBack="",t.disableVal="",document.getElementById("downLay").disabled=!1,document.getElementById("downLay").readOnly=!1,y("downLay"))})},a.GetFancyData(),shortcut.add("Enter",function(t){a.callActiveDeactive()}),shortcut.add("Alt+w",function(t){a.setMessage(1)}),a.callActiveDeactive=function(){if((void 0==a.NoLayRange||a.NoLayRange<a.downLay)&&(void 0==a.YesLayRange||a.YesLayRange>a.UpBack)){if(1==a.active)var t=0;else var t=1;var n={FancyId:a.ID,downLay:a.downLay,UpBack:a.UpBack,MaxStake:a.MaxStake,pointDiff:a.pointDiff,rateDiff:a.rateDiff,fStatus:t},c=BASE_URL+"Updowncntr/update_updownFancy";e.post(c,n).success(function(t){a.GetFancyData()}),y("downLay")}else{var o=a.downLay,i=a.UpBack;r.show({controller:"NormalFancyController",locals:{prntScope:a,downlay:o,upback:i,message:"You are out of Range Do you want to continue ..."},templateUrl:"app/scripts/directives/popupform/confirm_dialog.html",clickOutsideToClose:!1,escapeToClose:!1,fullscreen:!1})}},a.NormalFancyConfirm=function(t,n){if(1==a.active)var c=0;else if(0==a.active)var c=1;var o={FancyId:a.ID,downLay:t,UpBack:n,MaxStake:a.MaxStake,pointDiff:a.pointDiff,rateDiff:a.rateDiff,fStatus:c},i=BASE_URL+"Updowncntr/update_updownFancy";e.post(i,o).success(function(t){a.GetFancyData()}),y("downLay"),r.hide()},a.chnageRate=function(t){var n=parseInt(c.FancyID),o={RateChange:t,FancyId:n},i=BASE_URL+"Lstsavemstrcontroller/chnageRate";e.post(i,o).success(function(t){a.myVar=0,$("#inputNo").focus(),a.NoValume=100,a.YesValume=100})},a.PressEnter=function(){a.callActiveDeactive()},a.$on("$destroy",function(a){shortcut.remove("Enter"),shortcut.remove("Alt+w")}),a.checkInput=function(a){a||(a=window.event);var t=a.keyCode||a.which;if(!a.ctrlKey){if(8==t||13==t||9==t||27==t||46==t)return!0;if(t>=35&&39>=t)return!0;if(t>=96&&105>=t)return!0;if(isNaN(parseInt(String.fromCharCode(t),10)))return a.preventDefault(),!1}return!0},a.setLiability=function(){var t={FancyId:a.ID,liability:a.Liability};e.post(BASE_URL+"Lstsavemstrcontroller/setLiability/",t).success(function(t,e,n,c){a.SessionData=t.FancyData,i.autohide("Liability Updated Successfully...")})},a.RateDiffence=function(t){t||(t=window.event);t.keyCode||t.which;return 43==t.keyCode?(a.upDwnLay=a.upDwnLay+1,t.preventDefault(),!1):45==t.keyCode?(a.upDwnLay=a.upDwnLay-1,t.preventDefault(),!1):void 0},a.PointDifference=function(t){t||(t=window.event);t.keyCode||t.which;return 43==t.keyCode?(a.pointDiff=a.pointDiff+5,t.preventDefault(),!1):45==t.keyCode?(a.pointDiff=a.pointDiff-5,t.preventDefault(),!1):void 0},a.getVal=function(t){a.UpBack=t+a.rateDiff}}]),app.directive("userlist",function(){return{templateUrl:"app/scripts/directives/timeline/updownUselst.html",restrict:"E",replace:!0,scope:{myVar:"="},controller:["$scope","$http","$stateParams","get_userser","$interval",function(a,t,e,n,c){n.GetAllSessFancyBet(e.FancyID,function(t){a.myVar=0,a.GetSesFancyUserLst=t,n.GetFancyBal(e.FancyID,function(t){a.myVar=parseInt(t)})}),a.$parent.myVar=a.myVar,a.$parent.ChkUserUpdate=function(){n.GetAllSessFancyBet(e.FancyID,function(t){var c=a.GetSesFancyUserLst.length,o=t.length;a.GetSesFancyUserLst=t,n.GetFancyBal(e.FancyID,function(t){a.myVar=parseInt(t)}),c==o||(a.GetSesFancyUserLst=t)}),n.GetFancyBal(e.FancyID,function(t){a.myVar=parseInt(t)})},a.$parent.vChkUserUpdate=c(a.$parent.ChkUserUpdate,2e3),a.$on("$destroy",function(t){c.cancel(a.$parent.vChkUserUpdate),a.$parent.vChkUserUpdate=angular.isUndefinedOrNull})}]}}),app.controller("NormalFancyController",["$scope","$mdDialog","focus","prntScope","downlay","upback","message",function(a,t,e,n,c,o,i){a.HeaderMessage=i,a.yesClick=function(){n.NormalFancyConfirm(c,o)},a.noClick=function(){t.hide()},shortcut.remove("Enter"),shortcut.add("y",function(a){e("btnYes")}),shortcut.add("Left",function(a){e("btnYes")}),shortcut.add("n",function(a){e("btnNo")}),shortcut.add("Right",function(a){e("btnNo")}),a.$on("$destroy",function(a){shortcut.remove("y"),shortcut.remove("Left"),shortcut.remove("n"),shortcut.remove("Right"),shortcut.add("Enter",function(a){n.callActiveDeactive()})})}]);